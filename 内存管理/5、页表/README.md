### 参考
```
https://www.cnblogs.com/tolimit/p/4551428.html
```

### 1、概述  

页表是MMU用来自动查询虚拟地址到物理地址的映射情况，从而映射虚拟地址的Linux目前最新版本已经默认使用四级页表（PGD、PUD、PMD、PTE、OFFSET），根据平台的不同虚拟地址的位图也不同。  

- intel：
	1、32位没有启用PAE（物理地址扩展）使用2级页表（10，10，12可表示4GB）  
	2、32位启用PAE使用3级页表  
	
	3、64位使用3级页表或者四级页表（9,9,9,9,12=48，可表示256TB）  

### 2、PGD基地址  

- 1、x86  

	x86中使用CR3寄存器存储存储PGD基地址
	CR2寄存器缺页异常用

- 2、ARM  

### 3、内核页表和用户页表  

- 1、内核页表  
	所有进程通过用户态进入内核态（系统调用或者其他方法），都会公用内核页表，内核页表的页全局目录基地址保存在init_mm.pgd中。  

- 2、用户页表  
	每个进程都有自己独立的用户态页表  
	一般每个进程创建时只分配了一级页表表项，其他页表项会在产生缺页异常时动态创建  
	
### 4、线性地址位图  
- PGD  
	位数：PGD_OFFSET  
	目录项个数：PTRS_PER_PGD  
- PUD  
	位数：PUD_OFFSET  
	目录项个数：PTRS_PER_PUD，为1代表没有PUD  
- PMD  
	位数：PMD_OFFSET  
	目录项个数：PTRS_PER_PMD，为1代表没有PMD  
- PTE  
	位数：PAGE_OFFSET  
	目录项个数：PTRS_PER_PTE  
- OFFSET

Linux内核统一使用四级页表表示虚拟地址，PUD、PDM为1，代表使用2级页表，但实际也是四级映射